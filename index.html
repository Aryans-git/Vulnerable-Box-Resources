<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerable Box Resources</title>
    <link rel="icon" href="images/ai.png" sizes="192x192">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://raw.githubusercontent.com;">
</head>
<body>
    <div class="container">
        <!-- Header with Branding -->
        <header class="header">
            <a href="https://www.infosecwarrior.com/" target="_blank">
                <img src="images/logo.png" alt="InfoSecWarrior Logo" class="logo" loading="lazy">
            </a>
            <h1>
                <a href="https://vulnerable-box-resources.infosecwarrior.com/" aria-label="Vulnerable Box Resources Homepage">
                    Vulnerable Box Resources
                </a>
            </h1>
            <a href="https://www.armourinfosec.com/" target="_blank">
                <img src="images/armourinfosec.png" alt="Armour InfoSec Logo" class="logo armour-logo" loading="lazy">
            </a>            
        </header>

        <!-- Total Results Counter -->
        <p id="totalMachines" aria-live="polite">Total Vulnerable Machines: 0</p>
        
        <!-- Search Section -->
        <section class="searchsection">
            <div class="search" style="position: relative;">
                <input type="search" id="searchBar" class="searchbar" placeholder="Search..." aria-label="Search input">
            </div>
        </section>
        
        <p id="totalCount" aria-live="polite">Search Result: 0</p>

        <!-- Predefined Search Patterns -->
        <section class="predefined-patterns" aria-label="Predefined Search Patterns">
            <button data-pattern="machine:Kioptrix" aria-label="Filter by machine Kioptrix">machine:Kioptrix</button>
            <button data-pattern="port:80" aria-label="Filter by port 80">port:80</button>
            <button data-pattern="service:http" aria-label="Filter by service http">service:http</button>
            <button data-pattern="product:mysql" aria-label="Filter by product mysql">product:mysql</button>
            <button data-pattern="version:9" aria-label="Filter by version 9">version:9</button>
            <button data-pattern="platform:infosecwarrior" aria-label="Filter by platform InfoSecWarrior">platform:infosecwarrior</button>
        </section>

        <!-- Status with Loading Spinner -->
        <p id="status" aria-live="polite">
            <span id="statusMessage">Loading...</span>
            <span id="spinner" class="spinner" aria-hidden="true"></span>
        </p>

        <!-- Data Table -->
        <section class="table-container" aria-live="polite">
            <table>
                <thead>
                    <tr>
                        <th>Vulnerable Machine</th>
                        <th>Open Ports</th>
                        <th>Running Service</th>
                        <th>Software & Version</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Data will be populated dynamically -->
                </tbody>
            </table>
        </section>
        
        <!-- Pagination Controls -->
        <section class="pagination-container" aria-label="Pagination Controls">
            <button id="prevBtn" disabled aria-label="Previous Page" class="pagination-button">Back</button>
            
            <div class="pagination-pages">
                <!-- Page numbers will be dynamically generated here -->
            </div>
            
            <button id="nextBtn" disabled aria-label="Next Page" class="pagination-button">Next</button>
        </section>
        
    </div>

    <!-- JavaScript -->
    <script src="script.js" defer></script>
</body>
</html>